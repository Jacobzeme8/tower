import{_ as x,h as I,w as E,b as w,d as v,P as d,g as y,l as c,i as p,t as b,c as a,a as o,j as T,k as l,n as F,m as _,p as P,q as S,v as D,F as g,r as k,u as B,o as s,e as N,A as m,s as V,x as A,f as L}from"./index.69aa895a.js";const j={setup(){const i=I({}),n=B();async function f(){try{const t=n.params.eventId;c.log("getting event by id"),await y.getEventById(t)}catch(t){c.error(t),d.error(t)}}async function e(){c.log("getting commennts for event");try{const t=n.params.eventId;await p.getEventComments(t)}catch(t){c.error(t),d.error(t)}}async function h(){try{const t=n.params.eventId;await b.getTicketsForEvent(t)}catch(t){c.error(t),d.error(t)}}return E(()=>{n.params.eventId&&f()}),w(()=>{e(),h()}),{event:v(()=>m.activeEvent),account:v(()=>m.account),creator:v(()=>m.activeProfile),comments:v(()=>m.comments),tickets:v(()=>m.tickets),editable:i,boughtTicket:v(()=>!!m.tickets.find(u=>u.accountId==m.account.id)),async deleteEvent(){try{const t=n.params.eventId;await d.confirm("Are you sure you want to cancel this event?")&&await y.deleteEvent(t)}catch(t){c.error(t),d.error(t)}},async postComment(){try{const t=n.params.eventId,u=i.value;await p.postComment(u,t)}catch(t){c.error(t),d.error(t)}},async purchaseTicketForEvent(){try{const t=n.params.eventId;await b.purchaseTicketForEvent(t)}catch(t){c.error(t),d.error(t)}}}}},C=i=>(V("data-v-66ea7b26"),i=i(),A(),i),M={key:0,class:"container-fluid"},q={class:"row"},z={class:"col-10 m-auto"},R=["src"],U={class:"col-10 m-auto"},G={class:"card d-flex rounded-0 rounded-bottom p-2 align-items-center"},H={class:"d-flex justify-content-between"},J={key:0},K={key:1,class:"red-text"},O={key:2},Q={class:"d-flex justify-content-end"},W=["disabled"],X=["disabled"],Y={key:0,class:"col-10 m-auto pt-3"},Z={class:"card p-3"},$={class:"mb-3"},ee=C(()=>o("label",{for:"exampleFormControlTextarea1",class:"form-label"},"Post a Comment",-1)),te=C(()=>o("button",{class:"btn btn-success mt-2"},"Post",-1)),oe={class:"col-9 m-auto py-3"},ne={key:0,class:"card d-flex flex-row p-2"},ae=["title","src"],se={class:"col-8 m-auto p-2 mb-2"};function re(i,n,f,e,h,t){const u=L("CommentCard");return e.creator?(s(),a("div",M,[o("div",q,[o("div",z,[o("img",{class:"img-fluid cover-img mt-4 rounded-top",src:e.event.coverImg,alt:""},null,8,R)]),o("div",U,[o("div",G,[o("span",H,[o("h1",null,[T(l(e.event.name)+" ",1),e.event.isCanceled?_("",!0):(s(),a("span",{key:0,class:F(`${e.event.capacity==0?"red-text":""} `)}," Tickets Left: "+l(e.event.capacity),3))])]),e.event.isCanceled?(s(),a("h2",K," CANCELLED")):(s(),a("h4",J,"Date: "+l(e.event.startDate)+" "+l(e.event.location),1)),e.creator?(s(),a("h5",O,"Put together by: "+l(e.creator.name),1)):_("",!0),o("h5",null,"Type of event: "+l(e.event.type),1),o("p",null,l(e.event.description),1),o("div",Q,[o("button",{disabled:e.boughtTicket||e.event.isCanceled||e.event.capacity<=0||!e.account.id,onClick:n[0]||(n[0]=r=>e.purchaseTicketForEvent()),class:"btn btn-success mx-1"},"Purchase Ticket",8,W),e.creator.id==e.account.id?(s(),a("button",{key:0,disabled:e.event.isCanceled,class:"btn btn-danger mx-1",onClick:n[1]||(n[1]=r=>e.deleteEvent())},"Cancel Event?",8,X)):_("",!0)])])]),e.account.id?(s(),a("div",Y,[o("div",Z,[o("form",{onSubmit:n[3]||(n[3]=P(r=>e.postComment(),["prevent"]))},[o("div",$,[ee,S(o("textarea",{"onUpdate:modelValue":n[2]||(n[2]=r=>e.editable.body=r),class:"form-control",id:"exampleFormControlTextarea1",rows:"3"},null,512),[[D,e.editable.body]]),te])],32)])])):_("",!0),o("div",oe,[e.tickets[0]?(s(),a("div",ne,[(s(!0),a(g,null,k(e.tickets,r=>(s(),a("div",null,[o("img",{class:"img-fluid rounded-circle profile-picture ms-2",title:r.profile.name,src:r.profile.picture,alt:""},null,8,ae)]))),256))])):_("",!0)]),(s(!0),a(g,null,k(e.comments,r=>(s(),a("div",se,[N(u,{comment:r,creator:r.creator},null,8,["comment","creator"])]))),256))])])):_("",!0)}const ie=x(j,[["render",re],["__scopeId","data-v-66ea7b26"]]);export{ie as default};
